# upload=0; download=2330019758080; total=10995116277760; expire=4102329600;
mode: rule
mixed-port: 13766
allow-lan: false
log-level: info
ipv6: false
secret: cb01a88b-cc87-4bb5-80c6-ac13c2ca642f
external-controller: 127.0.0.1:9090
dns:
  enable: false
  ipv6: false
  listen: 0.0.0.0:53
  use-hosts: true
  enhanced-mode: fake-ip
  fake-ip-range: 192.18.0.1/16
  fake-ip-filter:
    - "*.lan"
    - localhost.ptlogin2.qq.com
    - +.stun.*.*
    - +.stun.*.*.*
    - +.stun.*.*.*.*
    - +.stun.*.*.*.*.*
    - "*.n.n.srv.nintendo.net"
    - +.stun.playstation.net
    - xbox.*.*.microsoft.com
    - "*.*.xboxlive.com"
    - "*.msftncsi.com"
    - "*.msftconnecttest.com"
    - "*.logon.battlenet.com.cn"
    - "*.logon.battle.net"
    - WORKGROUP
  default-nameserver:
    - 119.29.29.29
    - 119.28.28.28
    - 223.5.5.5
    - 223.6.6.6
  nameserver:
    - https://doh.pub/dns-query
    - https://1.12.12.12/dns-query
    - https://120.53.53.53/dns-query
    - https://dns.alidns.com/dns-query
    - https://223.5.5.5/dns-query
    - https://223.6.6.6/dns-query
tun:
  enable: false
  stack: system
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - any:53
profile:
  tracing: true
bind-address: "*"
proxy-groups:
  - name: 🛂 TRAFFIC-PRESORT
    type: select
    proxies:
      - 🔀 CLASH VERGE | 13766
proxies:
  - name: 🔀 CLASH VERGE | 13766
    type: socks5
    server: 127.0.0.1
    port: 13766
    udp: true

# 由于 CLASH VERGE 1.3.8 目前所使用的 Meta 内核存在 SUB-RULE 规则 BUG，
# 该 BUG 导致 PROCESS-NAME 无法正确匹配 SUB-RULE 规则。
# 因此推荐采用 CLASH FOR WINDOWS 作为前置代理，让部分支持配置代理的软件，
# 更精准地使用 CLASH VERGE 中提供的代理服务器。

# 本配置中仅有命中规则的域名或 IP 的网络流量会被转发到 CLASH VERGE 中，
# 其余未命中流量，将会使用 DIRECT 策略。

# 本规则多侧重于匹配域名，能够命中国外 IP 的规则仅占总规则的一小部分，
# 因此大多数国外的 IP 请求会使用 MATCH 规则，流向 DIRECT 策略。

# 推荐在需要频繁发起域名请求的软件中配置此前置代理，例如 IDM 或 PikPak 等；
# 但不推荐在类似 Google Drive 或 GitKraken 等软件中使用此前置代理。

# 类似于 Google Drive 或 GitKraken 等软件会发起纯国外的 IP 请求，这种请求
# 大概率无法命中本配置内的预设规则。
# 无法命中意味着会使用 MATCH 规则，即请求将流向 DIRECT 策略。这种情况下，
# 软件内大概率会出现资源请求超时的情况，表现为部分资源无法正确加载。

rules:
  - RULE-SET,addition-reject,REJECT
  - RULE-SET,addition-direct,DIRECT
  - RULE-SET,special-pikpak,🛂 TRAFFIC-PRESORT
  - RULE-SET,addition-proxy,🛂 TRAFFIC-PRESORT
  - RULE-SET,original-applications,DIRECT
  - RULE-SET,original-apple,DIRECT
  - RULE-SET,original-icloud,DIRECT
  - RULE-SET,original-private,DIRECT
  - RULE-SET,original-direct,DIRECT
  - RULE-SET,original-greatfire,🛂 TRAFFIC-PRESORT
  - RULE-SET,original-gfw,🛂 TRAFFIC-PRESORT
  - RULE-SET,original-proxy,🛂 TRAFFIC-PRESORT
  - RULE-SET,original-tld-not-cn,🛂 TRAFFIC-PRESORT
  - RULE-SET,original-reject,REJECT
  - RULE-SET,original-telegramcidr,🛂 TRAFFIC-PRESORT,no-resolve
  - RULE-SET,original-lancidr,DIRECT,no-resolve
  - RULE-SET,original-cncidr,DIRECT,no-resolve
  - GEOIP,LAN,DIRECT,no-resolve
  - GEOIP,CN,DIRECT,no-resolve
  - MATCH,DIRECT
rule-providers:
  addition-reject:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/addition/reject.yaml
    interval: 86400
  addition-direct:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/addition/direct.yaml
    interval: 86400
  special-pikpak:
    type: file
    behavior: classical
    path: h:/onedrive/repositories/proxy rules/commons/rules/special/pikpak.yaml
    interval: 86400
  addition-proxy:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/addition/proxy.yaml
    interval: 86400
  original-applications:
    type: file
    behavior: classical
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/applications.yaml
    interval: 86400
  original-apple:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/apple.yaml
    interval: 86400
  original-icloud:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/icloud.yaml
    interval: 86400
  original-private:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/private.yaml
    interval: 86400
  original-direct:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/direct.yaml
    interval: 86400
  original-greatfire:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/greatfire.yaml
    interval: 86400
  original-gfw:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/gfw.yaml
    interval: 86400
  original-proxy:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/proxy.yaml
    interval: 86400
  original-tld-not-cn:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/tld-not-cn.yaml
    interval: 86400
  original-reject:
    type: file
    behavior: domain
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/reject.yaml
    interval: 86400
  original-telegramcidr:
    type: file
    behavior: ipcidr
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/telegramcidr.yaml
    interval: 86400
  original-lancidr:
    type: file
    behavior: ipcidr
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/lancidr.yaml
    interval: 86400
  original-cncidr:
    type: file
    behavior: ipcidr
    path: h:/onedrive/repositories/proxy rules/commons/rules/original/cncidr.yaml
    interval: 86400
